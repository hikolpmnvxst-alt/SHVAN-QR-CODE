<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JEC QR Studio V4</title>
    <script src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <style>
        :root { --primary: #154E80; --accent: #38bdf8; --bg: #0f172a; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; display: flex; justify-content: center; padding: 20px; }
        .app-container { background: #1e293b; padding: 30px; border-radius: 25px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); width: 100%; max-width: 550px; }
        
        h2 { text-align: center; color: var(--accent); margin-bottom: 20px; font-weight: 900; }
        .input-group { margin-bottom: 20px; }
        input[type="text"] { width: 100%; padding: 15px; border-radius: 12px; border: none; background: #334155; color: white; font-size: 14px; outline: none; box-sizing: border-box; }
        
        .settings-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px; }
        select, .color-picker { width: 100%; padding: 12px; border-radius: 10px; background: #334155; color: white; border: 1px solid #475569; outline: none; cursor: pointer; }
        .label { font-size: 12px; color: #94a3b8; display: block; margin-bottom: 5px; text-align: right; }

        .full-width { grid-column: span 2; }
        .checkbox-card { background: #0f172a; padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 10px; cursor: pointer; border: 1px solid #38bdf8; }
        
        #canvas-container { margin: 25px 0; display: flex; justify-content: center; background: white; border-radius: 20px; padding: 20px; min-height: 300px; box-shadow: inset 0 0 10px rgba(0,0,0,0.1); }
        
        button { padding: 15px; border-radius: 12px; border: none; cursor: pointer; font-weight: bold; width: 100%; transition: 0.3s; margin-top: 10px; font-size: 16px; }
        .short-btn { background: var(--accent); color: #0f172a; }
        .dl-btn { background: #10b981; color: white; }
        button:hover { opacity: 0.9; transform: scale(0.98); }
    </style>
</head>
<body>

<div class="app-container">
    <h2>SHVAN QR MASTER</h2>
    
    <div class="input-group">
        <span class="label">لینکی ماڵپەڕ یان سۆشیاڵ میدیا:</span>
        <input type="text" id="qr-data" placeholder="لینک لێرە دابنێ..." value="">
        <button class="short-btn" onclick="shortenLink()">کورتکردنەوەی لینک و دروستکردن</button>
    </div>

    <div class="settings-grid">
        <div>
            <span class="label">١٠ ستایلی جیاواز (خاڵەکان):</span>
            <select id="dot-type" onchange="updateQR()">
                <option value="rounded">خڕی مۆدێرن</option>
                <option value="dots">خاڵی ورد (مرواری)</option>
                <option value="square">چوارگۆشەی کلاسیک</option>
                <option value="extra-rounded">فول ڕاوند</option>
                <option value="classy">شیکی جیاواز</option>
                <option value="classy-rounded">شیکی خڕکراو</option>
            </select>
        </div>
        <div>
            <span class="label">ڕەنگی کیوئاڕ:</span>
            <input type="color" id="qr-color" value="#154E80" class="color-picker" oninput="updateQR()">
        </div>

        <div class="full-width">
            <span class="label">ستایلی گۆشەکان (Corners):</span>
            <select id="corner-type" onchange="updateQR()">
                <option value="extra-rounded">گۆشەی زۆر خڕ</option>
                <option value="rounded">گۆشەی خڕ</option>
                <option value="square">گۆشەی تیژ</option>
                <option value="dot">گۆشەی بازنەیی</option>
            </select>
        </div>

        <div class="full-width checkbox-card" onclick="toggleLogo()">
            <input type="checkbox" id="logo-check" onchange="updateQR()">
            <span style="flex-grow: 1;">دروستکردنی بۆشایی لۆگۆ لە ناوەڕاست</span>
        </div>
    </div>

    <div id="canvas-container"></div>

    <button class="dl-btn" onclick="download()">داگرتنی وێنە (PNG)</button>
</div>

<script>
    // دروستکردنی ئۆبجێکتی کیوئاڕ بۆ یەکەمجار
    const qrCode = new QRCodeStyling({
        width: 300,
        height: 300,
        type: "svg",
        data: "JEC POST",
        dotsOptions: { type: "rounded", color: "#154E80" },
        backgroundOptions: { color: "#ffffff" },
        cornersSquareOptions: { type: "extra-rounded", color: "#154E80" },
        cornersDotOptions: { type: "dot", color: "#154E80" },
        qrOptions: { errorCorrectionLevel: "H" }
    });

    // کورتکردنەوەی لینک
    async function shortenLink() {
        const url = document.getElementById('qr-data').value;
        if(!url || url === "JEC POST") return alert("تکایە لینکێکی ڕاستەقینە بنووسە");
        try {
            const res = await fetch(`https://is.gd/create.php?format=json&url=${encodeURIComponent(url)}`);
            const data = await res.json();
            if(data.shorturl) {
                document.getElementById('qr-data').value = data.shorturl;
                updateQR();
            }
        } catch(e) { updateQR(); }
    }

    function toggleLogo() {
        const chk = document.getElementById('logo-check');
        chk.checked = !chk.checked;
        updateQR();
    }

    // نوێکردنەوەی کیوئاڕ بە شێوەی دەستبەجێ
    function updateQR() {
        const data = document.getElementById('qr-data').value || "JEC POST";
        const dotType = document.getElementById('dot-type').value;
        const cornerType = document.getElementById('corner-type').value;
        const color = document.getElementById('qr-color').value;
        const hasLogo = document.getElementById('logo-check').checked;

        qrCode.update({
            data: data,
            dotsOptions: { 
                type: dotType, 
                color: color 
            },
            cornersSquareOptions: { 
                type: cornerType, 
                color: color 
            },
            cornersDotOptions: { 
                type: "dot", 
                color: color 
            },
            image: hasLogo ? "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=" : "",
            imageOptions: { 
                hideBackgroundDots: true, 
                imageSize: 0.4, 
                margin: 10 
            }
        });
    }

    function download() {
        qrCode.download({ name: "JEC-QR-CODE", extension: "png" });
    }

    // لکاندنی کیوئاڕەکە بە شوێنی مەبەست
    qrCode.append(document.getElementById("canvas-container"));
    
    // یەکەم نوێکردنەوە بۆ دڵنیابوون لە ڕەنگ و ستایل
    updateQR();
</script>

</body>
</html>