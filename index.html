<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shvan QR Studio</title>
    <script src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <style>
        :root { --primary: #154E80; --accent: #38bdf8; --bg: #0f172a; }
        
        body { 
            font-family: 'Segoe UI', Tahoma, sans-serif; 
            background: var(--bg); 
            color: white; 
            display: flex; 
            justify-content: center; 
            padding: 10px; 
            margin: 0;
            min-height: 100vh;
        }

        .app-container { 
            background: #1e293b; 
            padding: 20px; 
            border-radius: 20px; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.4); 
            width: 100%; 
            max-width: 500px; 
            box-sizing: border-box;
            margin: auto;
        }
        
        h2 { text-align: center; color: var(--accent); margin-bottom: 20px; font-weight: 900; font-size: 1.5rem; }
        
        .input-group { margin-bottom: 15px; }
        
        input[type="text"] { 
            width: 100%; 
            padding: 14px; 
            border-radius: 12px; 
            border: none; 
            background: #334155; 
            color: white; 
            font-size: 14px; 
            outline: none; 
            box-sizing: border-box; 
            margin-bottom: 10px;
        }
        
        .settings-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 12px; 
            margin-top: 10px; 
        }
        
        select, .color-picker { 
            width: 100%; 
            padding: 10px; 
            border-radius: 10px; 
            background: #334155; 
            color: white; 
            border: 1px solid #475569; 
            outline: none; 
            cursor: pointer;
            box-sizing: border-box;
            height: 45px;
        }

        .label { font-size: 11px; color: #94a3b8; display: block; margin-bottom: 4px; text-align: right; }

        .full-width { grid-column: span 2; }
        
        .checkbox-card { 
            background: #0f172a; 
            padding: 12px; 
            border-radius: 12px; 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            cursor: pointer; 
            border: 1px solid #38bdf8; 
            user-select: none;
        }
        
        #canvas-container { 
            margin: 20px 0; 
            display: flex; 
            justify-content: center; 
            background: white; 
            border-radius: 15px; 
            padding: 10px; 
            min-height: 250px; 
            box-shadow: inset 0 0 10px rgba(0,0,0,0.1); 
            overflow: hidden;
        }

        /* Responsive QR Canvas */
        #canvas-container canvas, #canvas-container svg {
            max-width: 100% !important;
            height: auto !important;
        }
        
        button { 
            padding: 14px; 
            border-radius: 12px; 
            border: none; 
            cursor: pointer; 
            font-weight: bold; 
            width: 100%; 
            transition: 0.2s; 
            font-size: 15px; 
        }
        
        .short-btn { background: var(--accent); color: #0f172a; margin-bottom: 5px; }
        .dl-btn { background: #10b981; color: white; margin-top: 15px; }
        button:active { transform: scale(0.96); }

        /* Media Queries بۆ مۆبایلە زۆر بچووکەکان */
        @media (max-width: 400px) {
            .settings-grid { grid-template-columns: 1fr; }
            .full-width { grid-column: span 1; }
            .app-container { padding: 15px; }
            h2 { font-size: 1.2rem; }
        }
    </style>
</head>
<body>

<div class="app-container">
    <h2>SHVAN QR MASTER</h2>
    
    <div class="input-group">
        <span class="label">لینک لێرە دابنێ:</span>
        <input type="text" id="qr-data" placeholder="https://..." value="JEC POST">
        <button class="short-btn" onclick="shortenLink()">کورتکردنەوە و دروستکردن</button>
    </div>

    <div class="settings-grid">
        <div>
            <span class="label">ستایلی خاڵ:</span>
            <select id="dot-type" onchange="updateQR()">
                <option value="rounded">خڕ</option>
                <option value="dots">مرواری</option>
                <option value="square">چوارگۆشە</option>
                <option value="extra-rounded">فول ڕاوند</option>
            </select>
        </div>
        <div>
            <span class="label">ڕەنگ:</span>
            <input type="color" id="qr-color" value="#154E80" class="color-picker" oninput="updateQR()">
        </div>

        <div class="full-width">
            <span class="label">ستایلی گۆشەکان:</span>
            <select id="corner-type" onchange="updateQR()">
                <option value="extra-rounded">خڕ</option>
                <option value="square">تیژ</option>
                <option value="dot">بازنەیی</option>
            </select>
        </div>

        <div class="full-width checkbox-card" onclick="toggleLogo()">
            <input type="checkbox" id="logo-check" onchange="updateQR()">
            <span style="flex-grow: 1; font-size: 13px;">بۆشایی لۆگۆ لە ناوەڕاست</span>
        </div>
    </div>

    <div id="canvas-container"></div>

    <button class="dl-btn" onclick="download()">داگرتنی وێنە (PNG)</button>
</div>

<script>
    const qrCode = new QRCodeStyling({
        width: 300,
        height: 300,
        type: "svg",
        data: "JEC POST",
        dotsOptions: { type: "rounded", color: "#154E80" },
        backgroundOptions: { color: "#ffffff" },
        cornersSquareOptions: { type: "extra-rounded", color: "#154E80" },
        cornersDotOptions: { type: "dot", color: "#154E80" },
        qrOptions: { errorCorrectionLevel: "H" }
    });

    async function shortenLink() {
        const url = document.getElementById('qr-data').value;
        if(!url || url === "JEC POST") return;
        try {
            const res = await fetch(`https://is.gd/create.php?format=json&url=${encodeURIComponent(url)}`);
            const data = await res.json();
            if(data.shorturl) {
                document.getElementById('qr-data').value = data.shorturl;
                updateQR();
            }
        } catch(e) { updateQR(); }
    }

    function toggleLogo() {
        const chk = document.getElementById('logo-check');
        chk.checked = !chk.checked;
        updateQR();
    }

    function updateQR() {
        const data = document.getElementById('qr-data').value || "JEC POST";
        const dotType = document.getElementById('dot-type').value;
        const cornerType = document.getElementById('corner-type').value;
        const color = document.getElementById('qr-color').value;
        const hasLogo = document.getElementById('logo-check').checked;

        qrCode.update({
            data: data,
            dotsOptions: { type: dotType, color: color },
            cornersSquareOptions: { type: cornerType, color: color },
            cornersDotOptions: { type: "dot", color: color },
            image: hasLogo ? "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=" : "",
            imageOptions: { hideBackgroundDots: true, imageSize: 0.4, margin: 10 }
        });
    }

    function download() {
        qrCode.download({ name: "JEC-QR", extension: "png" });
    }

    qrCode.append(document.getElementById("canvas-container"));
    updateQR();
</script>

</body>
</html>
